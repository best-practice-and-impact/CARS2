---
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: 
      collapsed: false
params: 
  title: "Default"
  tables: NULL
  samples: NULL
title: "`r params$title`"
---

```{r global-options, include=FALSE}
# Set echo=false for all chunks
knitr::opts_chunk$set(echo=FALSE)
```

*Please note that this is a draft piece of analysis which has not yet undergone full quality assurance. Do not use this research for any purpose until this message is removed.*

# Coding frequency and tools

## Coding frequency

We asked our respondents, "In my current role, I write code to complete my work objectives _____". The frequencies for each answer are presented below. 

```{r }
library(magrittr)

tables <- params$tables

samples <- params$samples

```

```{r}
plot <- carsurvey2::plot_freqs(tables$freq_table, "Coding frequency", "Count", n = samples$all, font_size = 14)

table <- kableExtra::kable_styling(knitr::kable(tables$freq_table)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("coding-freq", plot, table)

```



## Programming languages - access and knowledge

For each of the most popular programming languages from last year's CARS data, we asked respondents to answer "yes", "no" or "I don't know" for the following statements: 

* I know how to program with this tool to a level suitable for my work
* This tool is available to use for my work

### Knowledge of programming tools

```{r}

plot <- carsurvey2::plot_stacked(tables$knowledge, xlab = "Count", ylab = "Programming tool", n = samples$all, colour_scale = "2gradients", font_size = 14)

table <- kableExtra::kable_styling(knitr::kable(tables$knowledge, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("tools-knowledge", plot, table)

```

### Access to programming tools

```{r}

plot <- carsurvey2::plot_stacked(tables$access, xlab = "Count", ylab = "Programming tool", n = samples$all, colour_scale = "2gradients", font_size = 14)

table <- kableExtra::kable_styling(knitr::kable(tables$access, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("tools-access", plot, table)

```

### Access and knowledge gaps

We used the above data to calculate the number of respondents who have access but no knowledge, access and knowledge, and knowledge but no access for each programming language. The results can be seen below.


```{r}

plot <- carsurvey2::plot_stacked(tables$code_tool_status, colour_scale = "scale", xlab = "Count", ylab = "Programming tool", n = samples$all, font_size = 14)

table <- kableExtra::kable_styling(knitr::kable(tables$code_tool_status, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("tools-status", plot, table)

```

# RAP knowledge and opinions


## Knowledge of RAP and RAP champions

We asked our respondents whether they had heard of RAP and what their knowledge is of their own department RAP champion. The combined responses are presented below.

```{r}

plot <- carsurvey2::plot_freqs(tables$rap_knowledge_chart, "Knowledge of RAP champions", "Count", n = samples$all, font_size = 14, orientation = "h", break_q_names_col = "RAP knowledge", max_lines = 3)

table <- kableExtra::kable_styling(knitr::kable(tables$rap_knowledge, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("rap-knowledge", plot, table)

```

## Opinions on RAP

We asked our respondents who had heard of RAP the extent to which they agree with the following statements:

* "I understand what the key components of the RAP methodology are"
* "I feel confident implementing RAP in my work"
* "I think it is important to implement RAP in my work"
* "I feel supported to implement RAP in my work"
* "I know where to find resources to help me implement RAP"
* "I and/or my team are currently implementing RAP"

The results can be seen below. The figure and table show the percentage of respondents who picked each response option. Percentages are out of a sample of respondents who said they had heard of RAP.


```{r}

plot <- carsurvey2::plot_likert(tables$rap_opinions_chart, 3, "Frequency", "Question", n = samples$heard_of_rap, font_size = 12, height = 700, break_q_names_col = "Question")

table <- kableExtra::kable_styling(carsurvey2::output_likert_table(tables$rap_opinions)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$heard_of_rap))

carsurvey2::wrap_outputs("rap-opinions", plot, table)

```

# RAP scores


## RAP components

The frequencies for each RAP component below are derived from a series of questions on coding practices (see the coding practices page). These were used to calculate scores for each component (0/1) where respondents answered "regularly" or "all the time" to the relevant questions. The list of RAP components used here is based on the [RAP minimum viable product](https://github.com/best-practice-and-impact/rap_mvp_maturity_guidance/blob/master/Reproducible-Analytical-Pipelines-MVP.md) guidance agreed by the RAP champions network.

```{r}

plot <- carsurvey2::plot_grouped(tables$components, "RAP component", "Count", n = samples$coders, orientation = "h", font_size = 14)

table <- kableExtra::kable_styling(knitr::kable(tables$components, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("rap_comps", plot, table)

```

Below are the distributions of total basic and advanced RAP scores. These are the sum of the scores for each RAP component.

## Basic RAP scores

```{r}

bar_colour <- carsurvey2::get_2colour_scale(2)[2][[1]]
bar_colour <- rgb(bar_colour[1],bar_colour[2],bar_colour[3], maxColorValue = 255)

plot <- carsurvey2::plot_freqs(tables$basic_freqs, "Basic RAP score", "Count", bar_colour = bar_colour, n = samples$coders, font_size = 14)

table <- kableExtra::kable_styling(knitr::kable(tables$basic_freqs, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("basic_score", plot, table)

```

## Advanced RAP scores

```{r}

plot <- carsurvey2::plot_freqs(tables$advanced_freqs, "Advanced RAP score", "Count", n = samples$coders, font_size = 14)

table <- kableExtra::kable_styling(knitr::kable(tables$advanced_freqs, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("advanced_score", plot, table)

```

# Coding practices

We asked respondents to report how often they make use of each of the coding practices presented below. Please note that while there are many different coding practices listed below, we understand that not all are proportionate for every coding project. 

## General coding practices

```{r}

plot <- carsurvey2::plot_likert(tables$code_prac_chart, 3, "Frequency", "Question", n = samples$coders, neutral_mid = FALSE, font_size = 14, height = 700, break_q_names_col = "question")

table <- kableExtra::kable_styling(carsurvey2::output_likert_table(tables$code_prac_chart)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("code-prac", plot, table)

```

## Documentation

```{r}

plot <- carsurvey2::plot_likert(tables$doc, 3, "Frequency", "Question", n = samples$coders, neutral_mid = FALSE, font_size = 14, height = 700, break_q_names_col = "Question")

table <- kableExtra::kable_styling(carsurvey2::output_likert_table(tables$doc)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("doc", plot, table)

```
