install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2", dependencies = TRUE, type = "win.binary")
install.packages("rlang")
install.packages("rlang", type = "win.binary", dependencies = "TRUE")
install.packages("rlang"
install.packages("rlang");
install.packages("rlang");
x <- [1,0,0,1]
x <- (1,0,0,1)
x <- c(1,0,0,1)
x
x*2
x <-c((1,0,1),(1,2,1))
x <- c(0,1,1,1)
x
setwd("//mdata1/buckls$/My Documents/CARS2/CARS-2")
data <- read.csv("latest_data.csv", na.strings = c("", ".", "NA", "-"))
data <- read.csv("../../latest_data.csv", na.strings = c("", ".", "NA", "-"))
data <- read.csv("../../data/latest_data.csv", na.strings = c("", ".", "NA", "-"))
data <- read.csv("../data/latest_data.csv", na.strings = c("", ".", "NA", "-"))
original_colnames <- colnames(data)
get_qnames <- function(colname) {
if (stringr::str_detect(colname, "Q")) {
return(stringr::str_split(
string = colname,
pattern = "[.]",
simplify = T
)[1])
} else if (stringr::str_detect(colname, "X")) {
return(NA)
} else {
return(colname)
}
}
q_numbers <- c(unname(sapply(colnames(data), get_qnames)))
q_numbers <- zoo::na.locf(q_numbers)
q_freqs <- data.frame(table(q_numbers))
q_freqs$q_numbers <-
factor(q_freqs$q_numbers, levels = unique(q_numbers))
q_freqs <- q_freqs[order(q_freqs$q_numbers),]
label_duplicates <- function(name, freq) {
if (freq == 1) {
return(as.character(name))
} else {
return(c(paste0(rep(name, freq),
c(
"", rep(".", freq - 1)
),
c("", c(
1:(freq - 1)
)))))
}
}
new_colnames = Map(label_duplicates, q_freqs$q_numbers, q_freqs$Freq)
new_colnames <- purrr::flatten(new_colnames)
colnames(data) <- new_colnames
data <- data[-c(1, 2), ]
data <-  subset(data, select = -c(
UserNo,
Name,
Email,
IP.Address,
Unique.ID,
Started,
Ended
)
)
names(data)[names(data) == "Ã¯..UserID"] <-  "unique.ID"
data <- data.frame(
lapply(data, function(x) {
gsub("Don@SQ@t Know", "Don't Know", x)
})
)
save(data, file = "relabelled_data.Rdata")
head(data)
View(data)
head(new_colnames)
colnames(data)
#simple labelling for q1 (what to do about 1.1),q2=grade, q4=location, q6=edu_level columns
colnames(data)[5]
#simple labelling for q1 (what to do about 1.1),q2=grade, q4=location, q6=edu_level columns
colnames(data)[5] <- "grade"
#simple labelling for q1 (what to do about 1.1),q2=grade, q4=location, q6=edu_level columns
colnames(data)[5]
colnames(data)
colnames(data)[5,10]
colnames(data)[5][10]
colnames(data)[10]
colnames(data)[19]
colnames(data)[19] <- "location"
colnames(data)[21]
colnames(data)[21] <- "edu_level"
colnames(data)
#q1 dept needs to link with 1.1
colnames(data)[3]
#q1 dept needs to link with 1.1
colnames(data)[3] <- dept
#q1 dept needs to link with 1.1
colnames(data)[3] <- "dept"
